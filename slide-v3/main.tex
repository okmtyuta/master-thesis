\documentclass{okclss}
\usepackage{caption}
\usepackage[
  backend=biber,
  style=verbose-note,
  sorting=ynt
]{biblatex}
\usepackage{animate}
\renewcommand{\thefootnote}{[\arabic{footnote}]}
\makeatletter
\renewcommand{\@makefnmark}{\hbox{\normalfont\thefootnote}}
\makeatother

\addbibresource{references.bib}

\title{
  Lipschitz Continuity of Persistence Diagrams Derived from Turing Patterns \\
  チューリングパターンから得られるパーシステンス図のリプシッツ連続性 \\
}
\author{
  OKAMOTO Yuta
  \thanks{京都大学大学院情報学研究科情報学専攻データ科学コース情報論的学習分野}
}

\begin{document}
\maketitle

\sectionframe{Introduction}

\begin{frame}
  \frametitle{エンゼルフィッシュの縞模様}

  海水エンゼルフィッシュは特徴的な縞模様を持つ。
  
  この縞模様の発生や変化をコンピューターで予測することはできるだろうか？

  \begin{figure}[h]
    \centering
    \includegraphics[width=12 cm]{figures/angelfish.png}
    \caption*{海水エンゼルフィッシュの体表パターンと対応するTuringパターン[2]}
  \end{figure}

\end{frame}
\begin{frame}
  \frametitle{エンゼルフィッシュの縞模様}

  KondoとAsaiの研究\footcite{kondo1995reaction}はその疑問に答えている。
  
  すなわち，チューリングパターンの理論を利用することにより，海水エンゼルフィッシュの成長による縞模様の変化をシミュレーションで予測することに成功した。

  \begin{figure}[h]
    \centering
    \includegraphics[width=12 cm]{figures/angelfish.png}
    \caption*{海水エンゼルフィッシュの体表パターンと対応するTuringパターン[2]}
  \end{figure}

\end{frame}

\begin{frame}
  \frametitle{チューリングパターン}

  A. M. Turingの研究\footcite{turing1990chemical}は，生物の特徴的な体表パターンは，モルフォゲンと総称される化学物質の濃度分布が反応拡散方程式に従って変化することによって生じると提唱した。
  \begin{align*}
    \dfrac{ \partial u_i }{ \partial t } = \lambda_i \Delta u_i + R_i \left( u_1, \cdots, u_n; \theta \right) ~ \left( 1 \leq i \leq n \right)
  \end{align*}
  ただし，$u_i$は各モルフォゲンの濃度，$\lambda_i \Delta u_i$は拡散項，$R_i$は反応項，$\theta$は反応項のパラメータを表している。

  反応拡散系によって生じるパターンは（広い意味で）\alert{チューリングパターン}と呼ばれる。ジャガーやシマウマなどの多様な動物の体表パターン変化がチューリングパターンによって予測できると報告されている\footcite{gravan2004evolving}\footcite{liu2006two}。

\end{frame}

% \begin{frame}
%   \frametitle{チューリングパターン}

%   % 海水エンゼルフィッシュなどのさまざまな生物のパターンがチューリングパターンによって説明できることが知られている \footcite{kondo1995reaction}\footcite{gravan2004evolving}\footcite{liu2006two}。

%   \begin{figure}[h]
%     \centering
%     \includegraphics[width=12 cm]{figures/angelfish.png}
%     \caption{海水エンゼルフィッシュの体表パターンと対応するTuringパターン\footcite{kondo1995reaction}}
%   \end{figure}
  
% \end{frame}

\begin{frame}
  \frametitle{パーシステントホモロジーのチューリングパターンへの応用}

  近年のサーベイ\footcite{volkening2024methods}では，チューリングパターン対する定量的解析手法として\alert{トポロジカルデータ解析}が紹介されている。

  トポロジカルデータ解析は，データの「形状」を定量的に調べる手法として近年大きく発展している \footcite{carlsson2009topology}。
  
  特に，\alert{パーシステントホモロジー}\footcite{edelsbrunner2002topological}はトポロジカルデータ解析の代表的手法であり，材料科学\footcite{nakamura2015persistent}\footcite{hiraoka2016hierarchical}やタンパク質科学\footcite{gameiro2015topological}などの広い分野に応用されている。

\end{frame}

\begin{frame}
  \frametitle{パーシステントホモロジー}

  パーシステントホモロジーは，データを時系列的に変化させ，ホモロジーの生成と消滅を調べる。

  \begin{figure}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{figures/fig2.pdf}
  \end{figure}

  % データの形式が離散集合でも関数でもパーシステントホモロジーは構成することができる。

  % \input{figures/pointcloud.tex}
\end{frame}

\begin{frame}
  \frametitle{パーシステンス図}

  \begin{minipage}{0.53\linewidth}
    パーシステンス図：パーシステントホモロジーの要約量
    
    パーシステンス図は，ホモロジーとして「穴」を調べる場合，「穴」が生成した時刻を$x$軸に，消滅した時刻を$y$軸にプロットして作成する。

    パーシステントホモロジーは離散的なデータだけではなく，関数に対しても定義できる。
    
    関数$f$から定まるパーシステンス図は$\mathrm{dgm}~f$と書くことにする。
  \end{minipage}
  \hfill
  \begin{minipage}{0.44\linewidth}
    \input{figures/persistent-diagram.tex}
  \end{minipage}
\end{frame}

\begin{frame}
  \frametitle{ボトルネック距離}

  \begin{minipage}[t]{0.53\linewidth}
    \vspace{0pt}
    パーシステンス図の間にはボトルネック距離$d_B$という距離が存在し，ボトルネック距離を利用することでパーシステンス図が比較できる。

    ボトルネック距離は，パーシステンス図の点の間の最大マッチングによって定まる。だだし，マッチングできなかった点は対角線と垂直にマッチングさせる。
  \end{minipage}
  \hfill
  \begin{minipage}[t]{0.44\linewidth}
    \vspace{0pt}
    \input{figures/bottleneck.tex}
  \end{minipage}
\end{frame}

\begin{frame}
  \frametitle{パーシステントホモロジーの応用}

  パターン形成系に対するパーシステントホモロジーの応用に関する研究はすでに多く行われている。特に，\footcite{spector2024persistent}ではパーシステントホモロジーを活用して，反応拡散系のパラメータをクラスタリングするアルゴリズムを開発している。

  この研究から，\alert{\textbf{反応拡散系のパラメータの類似性とパーシステントホモロジーの類似性の間には強い関係がある}}ことが示唆される。

\end{frame}

\begin{frame}
  \frametitle{本研究の概要}
  % この目的を達成するためにパーシステンス図とパラメータの間のリプシッツ連続性を解析する。

% \end{frame}

% \begin{frame}
  % \frametitle{本研究の概要}

  本研究の目的は，\alert{\textbf{反応拡散系のパラメータの類似性とパーシステントホモロジーの類似性の間の関係性を数理的に解析すること}}である。研究の目的を達成するためにパーシステンス図とパラメータの間のリプシッツ連続性を解析する。
  \vspace{-0.7cm}
  \begin{center}
    リプシッツ連続性: $\text{ボトルネック距離} \leq \text{定数} \times \text{パラメータの一様ノルム}$
  \end{center}
  \vspace{-0.7cm}
  \begin{figure}[h]
    \centering
    \includegraphics[width=0.7\linewidth]{figures/fig1.pdf}
  \end{figure}

\end{frame}

% \begin{frame}
%   \frametitle{パーシステンス図}

%   \begin{minipage}{0.53\linewidth}
%     パーシステントホモロジーによって得られるホモロジーの時系列変化はパーシステンス図という集合に要約される。
    
%     パーシステンス図は，ホモロジーとして「穴」を調べる場合，「穴」が生成した時刻を$x$軸に，消滅した時刻を$y$軸にプロットして作成する。

%     関数$f$から定まるパーシステンス図は$\mathrm{dgm}~f$と書くことにする。

%     パーシステンス図の間には\alert{ボトルネック距離$d_B$}という距離が存在する。
%   \end{minipage}
%   \hfill
%   \begin{minipage}{0.44\linewidth}
%     \input{figures/persistent-diagram.tex}
%   \end{minipage}
% \end{frame}

% \sectionframe{Preliminary}

% \begin{frame}
%   \frametitle{パーシステントホモロジー}
  
%   データが関数で与えられているとき，データの時系列的変化は劣位集合フィルトレーションとして表現される。

%   \begin{dfn*}
%     $X$を位相空間とし，$f: X \to \mathbb{R}$を$X$上の実数値関数とするとき，任意の$a \in \mathbb{R}$に対して，$\Set{ f \leq a } = \Set{ x \in X | f\left( x \right) \leq a }$とおく。このとき，$X$の部分位相空間の増大列
%     \begin{align*}
%       \mathcal{F} \left[ f \right] = \left( \Set{ f \leq a } \right)_{a \in \mathbb{R}}
%     \end{align*}
%     を$f$の劣位集合フィルトレーションという。
%   \end{dfn*}

% \end{frame}

% \begin{frame}
%   \frametitle{パーシステントホモロジー}

%   パーシステントホモロジーでは，増大列（劣位集合フィルトレーション）の各点に対してホモロジー群$H_p \left( \cdot \right)$とホモロジー群の間の準同型$\left(  i_{\cdot, \cdot}\right)_*$を組み合わせることにより，ホモロジーの変化を追跡する。

%   \begin{dfn*}
%     $p \geq 0$を負でない整数とする。$X$を位相空間とし，$f: X \to \mathbb{R}$を$X$上の実数値関数とする。また，任意の$a \leq b$に対して，包含写像$i_{a, b}: \Set{ f \leq a } \to \Set{ f \leq b }$が誘導する準同型を$\left( i_{a, b} \right)_*: H_p \left( \Set{ f \leq a } \right) \to H_p \left( \Set{ f \leq b } \right)$とかく。このとき，
%     \begin{align*}
%       H_p \left( \mathcal{F} \left[ f \right] \right) = \left( \left( H_n \left( \Set{ f \leq a }\right) \right)_{a \in \mathbb{R}}, \left( \left( i_{a, b} \right)_* \right)_{a \leq b} \right)
%     \end{align*}
%     を$f$の$n$次元パーシステントホモロジーという。
%   \end{dfn*}

% \end{frame}

% \begin{frame}
%   \frametitle{パーシステンス図}

%   \begin{eg*}
%     距離空間$\left( X, d \right)$上の離散点集合$C$と点$x$に対して，$d_C \left( x \right) = d \left( C, x \right)$とおく。このとき，$\Set{ d_C \leq a } = \bigcup_{c \in C} \Set{ d \left( c, x \right) \leq a }$となるから，$d_C$のパーシステントホモロジーは，以下の図形のホモロジーを調べている。
%   \end{eg*}

%   \input{figures/pointcloud-v2.tex}
% \end{frame}



% \begin{frame}
%   \frametitle{パーシステントホモロジーの安定性定理}

%   $X$上の関数$f:X \to \mathbb{R}$に対して，$f$から定まる$p$次のパーシステンス図を$\mathrm{dgm}_p~f$と書くことにする。

%   \begin{thm*}[\footcite{cohen2005stability}]
%     $X$を位相空間とする。二つのq-tameな関数$f, g: X \to \mathbb{R}$に対して，
%     \begin{align*}
%       d_B \left( \mathrm{dgm}_p~f, \mathrm{dgm}_p~g \right) \leq \left\| f - g \right\|_{\infty}
%     \end{align*}
%     が成り立つ。
%   \end{thm*}

% \end{frame}

\sectionframe{Theory}

\begin{frame}
  \frametitle{問題設定}

  以下の一般の反応拡散系を考える
  \begin{align*}
    \begin{dcases}\label{eq:reaction-diffusion-equations-normal}
      \dfrac{\partial u_i}{\partial t} \left( x, t \right) = \lambda_i \Delta u_i \left( x, t \right) + R_i \left( u_1 \left( x, t \right), \dots, u_n \left( x, t \right); \theta \right), & \left( x, t \right) \in \left[ 0, 1 \right]^d \times \left( 0, T \right] \\
      u_i \left( x, 0 \right) = \tilde{u}_i \left( x \right), & x \in \left[ 0, 1 \right]^d \\
      1 \leq i \leq n
    \end{dcases}
  \end{align*}
  境界条件は周期境界条件を考える。パラメータ$\lambda_i$および$\theta$の空間はコンパクトとする。

  パラメータ$D = \left( \lambda_1, \dots, \lambda_n \right), \theta$および$D^\prime = \left( \lambda_1^\prime, \dots, \lambda_n^\prime \right), \theta^\prime$に対応する反応拡散系の解をそれぞれ$U = \left( u_1, \dots, u_n \right)$および$U^\prime = \left( u_1^\prime, \dots, u_n^\prime \right)$とする。ただし，初期値$\tilde{u}_i$は共通とする。
\end{frame}

\begin{frame}
  \frametitle{主定理}

  \begin{thm*}\label{thm:main-theorem}
    $D, D^\prime$および$\theta, \theta^\prime$に依存しない定数$L_1, L_2, L_3, L_4 \in \mathbb{R}$が存在して，任意の$x \in \left[ 0, 1 \right]^d$および$0 \leq t \leq T$に対して，
    \begin{align*}
      \left\| R_i \left( U \left( \cdot, t \right); \theta \right) - R_i \left( U^\prime \left( \cdot, t \right); \theta^\prime \right) \right\|_\infty
      &\leq L_1 \left\| \left( U \left( \cdot, t \right) \right)- \left( U^\prime \left( \cdot, t \right) \right)  \right\|_\infty
      + L_2 \left\| \theta - \theta^\prime \right\|_\infty\\
      \left\| R_i \left( U \left( \cdot, t \right); \theta \right) \right\|_\infty
      &\leq L_3, \quad
      \left\| R_i \left( U^\prime \left( \cdot, t \right); \theta^\prime \right) \right\|_\infty
      \leq L_3\\
      \left\| U \left( \cdot, t \right) \right\|_\infty
      &\leq L_4, \quad
      \left\| U^\prime \left( \cdot, t \right) \right\|_\infty
      \leq L_4
    \end{align*}
    が成り立つとする。このとき，任意の$0 \leq t \leq T$に対して，$D, D^\prime$および$\theta, \theta^\prime$に依存しない$M_1 \left( t \right), M_2 \left( t \right) \in \mathbb{R}$が存在して，
    \begin{align*}
      d_B \left( \mathrm{dgm}~u_i \left( \cdot, t \right), \mathrm{dgm}~u_i^\prime \left( \cdot, t \right) \right) \leq M_1 \left( t \right) \left\| D - D^\prime \right\|_\infty + M_2 \left( t \right) \left\| \theta - \theta^\prime \right\|_\infty
    \end{align*}
    が成り立つ（パラメータが類似していればパーシステンス図も類似している）。
  \end{thm*}

\end{frame}

\begin{frame}
  \frametitle{証明の概略}

  広いクラスの関数$f, g$に対して，$d_B \left( \mathrm{dgm}~f, \mathrm{dgm}~g \right) \leq \left\| f - g \right\|_\infty$が成り立つことが知られている（安定性定理\footcite{cohen2005stability}）。よって，ボトルネック距離を評価するためには，$\left\| f - g \right\|_\infty$を評価すればいい。

  修士論文中では$\left\| u_i \left( \cdot, t \right) - u_i^\prime \left( \cdot, t \right) \right\|_\infty$の評価式を構成することによって主定理を証明した。
  \begin{align*}
    d_B \left( \mathrm{dgm}~u_i \left( \cdot, t \right), \mathrm{dgm}~u_i^\prime \left( \cdot, t \right) \right) &\leq M_1 \left( t \right) \left\| D - D^\prime \right\|_\infty + M_2 \left( t \right) \left\| \theta - \theta^\prime \right\|_\infty \\
    M_1 \left( t \right) &= \dfrac{d}{\inf_{\lambda^* \in \Lambda} \lambda^*} \left( L_4 + L_3 t \right) e^{L_1 t} \\
    M_2 \left( t \right) &= L_2 t e^{L_1 t}
  \end{align*}
  ただし，$\Lambda$は$\lambda_i$のパラメータ空間である。

\end{frame}

\sectionframe{Simulation study}

\begin{frame}
  \frametitle{シミュレーション設定}

  代表的な反応拡散系であるGray--Scottモデルに対して，主定理に関する数値シミュレーションを行った。Gray--Scottモデルは主定理の条件を満たす。Gray--Scottモデルは次で与えられる。
  \begin{align*}
    \begin{dcases}
      \dfrac{\partial u_1}{\partial t} = \lambda_1 \Delta u_1 - u_1 u_2^2 + F(1-u_1)\\
      \dfrac{\partial u_2}{\partial t} = \lambda_2 \Delta u_2 + u_1 u_2^2 - (F+k)u_2
    \end{dcases}
  \end{align*}

  特に，$\theta = \left( F, k \right)$だけを変動させるシミュレーションを行った。

  \begin{figure}[h]
    \centering
    \includegraphics[width=0.70\linewidth]{figures/parameters.png}
  \end{figure}

\end{frame}

\begin{frame}

  \begin{minipage}[t]{0.35\linewidth}
    \vspace{0pt}
    以下の関係性を視覚的に評価した。
    \begin{itemize}
      \item パラメータの類似性
      \item パターンの類似性
      \item パーシステンス図の類似性
    \end{itemize}
  \end{minipage}
  \begin{minipage}[t]{0.60\linewidth}
    \vspace{0pt}
    \includegraphics[width=\linewidth]{figures/view_u_tilde_series.png}
  \end{minipage}

\end{frame}

\begin{frame}

  パラメータが類似していれば，パーシステンス図の点の配置も類似していることがわかる。
  \begin{figure}[h]
    \centering
    \includegraphics[width=\linewidth]{figures/view_u_tilde_series-v2.png}
  \end{figure}

\end{frame}

\begin{frame}
  Gray--Scottモデルに対して，以下の不等式をシミュレーションした。ただし，結果は対数スケールで示している。
  \begin{align*}
    \notice{d_B \left( \mathrm{dgm}~u_1 \left( \cdot, t \right), \mathrm{dgm}~u_1^\prime \left( \cdot, t \right) \right)}
    &\leq \alert{M_1 \left( t \right) \left\| D - D^\prime \right\|_\infty + M_2 \left( t \right) \left\| \theta - \theta^\prime \right\|_\infty}
  \end{align*}

  不等式は成立している。
  \begin{figure}[h]
    \begin{minipage}{0.32\linewidth}
      \centering
      \includegraphics[width=\linewidth]{figures-thesis/exp1_result_theta1_theta1_prime.png}
    \end{minipage}
    \hfill
    \begin{minipage}{0.32\linewidth}
      \centering
      \includegraphics[width=\linewidth]{figures-thesis/exp1_result_theta2_theta2_prime.png}
    \end{minipage}
    \hfill
    \begin{minipage}{0.32\linewidth}
      \centering
      \includegraphics[width=\linewidth]{figures-thesis/exp1_result_theta1_theta2.png}
    \end{minipage}
  \end{figure}

\end{frame}

\sectionframe{Conclusion}

\begin{frame}
  \frametitle{研究成果}

  本研究では，\alert{反応拡散系のパラメータの類似性とパーシステントホモロジーの類似性の間の関係}を\alert{パーシステンス図とパラメータの間のリプシッツ連続性}という形で検討した。
  \begin{align*}
    d_B \left( \mathrm{dgm}~u_i \left( \cdot, t \right), \mathrm{dgm}~u_i^\prime \left( \cdot, t \right) \right) \leq M_1 \left( t \right) \left\| D - D^\prime \right\|_\infty + M_2 \left( t \right) \left\| \theta - \theta^\prime \right\|_\infty
  \end{align*}
  また，この結果は数値シミュレーションで妥当性が確認された。

  しかし，本研究には多くの課題が残されている。

\end{frame}

\begin{frame}
  \frametitle{有限時間の仮定}

  本研究では，反応拡散系を有限時間区間$\left[ 0, T \right]$上で考えていたが，実際の反応拡散系の研究では，十分に時間が経った定常状態を考えることも少なくない。

  時間$t$が大きくなると$M_1 \left( t \right)$および$M_2 \left( t \right)$が指数的に大きくなってしまうため，十分に時間が経った状況を本研究で示した不等式で扱うことは難しい。
  \begin{align*}
    d_B \left( \mathrm{dgm}~u_i \left( \cdot, t \right), \mathrm{dgm}~u_i^\prime \left( \cdot, t \right) \right)
    &\leq \alert{M_1 \left( t \right)} \left\| D - D^\prime \right\|_\infty + \alert{M_2 \left( t \right)} \left\| \theta - \theta^\prime \right\|_\infty \\
    M_1 \left( t \right) &= \dfrac{d}{\inf_{\lambda^* \in \Lambda} \lambda^*} \left( L_4 + L_3 t \right) e^{L_1 t} \\
    M_2 \left( t \right) &= L_2 t e^{L_1 t}
  \end{align*}

\end{frame}

\begin{frame}
  \frametitle{手法の弱点}

  次のような不等式を構成することで主定理は証明された。
  \begin{align*}
    d_B \left( \mathrm{dgm}~u_i \left( \cdot, t \right), \mathrm{dgm}~u_i^\prime \left( \cdot, t \right) \right)
    &\leq \left\| u_i \left( \cdot, t \right) - u_i^\prime \left( \cdot, t \right) \right\|_\infty \\
    &\leq M_1 \left( t \right) \left\| D - D^\prime \right\|_\infty + M_2 \left( t \right) \left\| \theta - \theta^\prime \right\|_\infty
  \end{align*}
  これでは解の性質を調べているだけで，データの「形」を調べるというパーシステントホモロジーの性質を本質的には利用できていない。

  関数としては類似性が小さいが，パターンとしては類似性が大きいため，パーシステントホモロジーの類似性も大きくなるような状況に対応できる枠組みを考える必要がある。

\end{frame}

\begin{referenceframe}
  \printbibliography
\end{referenceframe}

\end{document}
