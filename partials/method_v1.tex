\section{Method}\label{sec:method}

\subsection{Problem setting}

In this section, as outlined in the Introduction, we investigate the Lipschitz continuity of persistence diagrams arising from Turing patterns. We begin by formulating a general parameterized reaction-diffusion system and stating the theorem we aim to establish for this class of systems. The proof is then carried out using the concepts and results prepared in the Preliminary section.

Let $n, d, q$ be positive integers and let $T > 0$ be a positive real number. Set $\Omega = \left[ 0, 1 \right]^d$ and $\Lambda \subset \left( 0, \infty \right)$ and $\Theta \subset \left( 0, \infty \right)^q$ be compact sets. We consider the following two parameterized reaction-diffusion systems:
\begin{align}
  &\begin{dcases}\label{eq:reaction-diffusion-equations-normal}
    \dfrac{\partial u_i}{\partial t} \left( x, t \right) = \lambda_i \Delta u_i \left( x, t \right) + R_i \left( u_1 \left( x, t \right), \dots, u_n \left( x, t \right); \theta \right), & \left( x, t \right) \in \Omega \times \left( 0, T \right] \\
    u_i \left( x, 0 \right) = \tilde{u}_i \left( x \right), & x \in \Omega\\
    1 \leq i \leq n,\\
  \end{dcases}\\
  &\begin{dcases}\label{eq:reaction-diffusion-equations-prime}
    \dfrac{\partial u_i^\prime}{\partial t} \left( x, t \right) = \lambda_i^\prime \Delta u_i^\prime \left( x, t \right) + R_i \left( u_1^\prime \left( x, t \right), \dots, u_n^\prime \left( x, t \right); \theta^\prime \right), & \left( x, t \right) \in \Omega \times \left( 0, T \right] \\
    u_i^\prime \left( x, 0 \right) = \tilde{u}_i \left( x \right), & x \in \Omega\\
    1 \leq i \leq n,\\
  \end{dcases}
\end{align}
where $D = \left( \lambda_1, \dots, \lambda_n \right), D^\prime = \left( \lambda_1^\prime, \dots, \lambda_n^\prime \right) \in \Lambda^n$ and $\theta, \theta^\prime \in \Theta$ are parameters of the systems. We impose periodic boundary conditions on $\Omega$. We also denote by $U = \left( u_1, \dots, u_n \right)$ and $U^\prime = \left( u_1^\prime, \dots, u_n^\prime \right)$ the vector-valued solutions of \eqref{eq:reaction-diffusion-equations-normal} and \eqref{eq:reaction-diffusion-equations-prime}, respectively. Furthermore, we define $\left\| U \right\|_\infty = \max \set{ \left\| u_1 \right\|_\infty, \cdots, \left\| u_n \right\|_\infty }$.

Under this setting, for each $1 \leq i \leq n$, we investigate how the bottleneck distance between the $p$-dimensional persistence diagrams $\mathrm{dgm}_p~u_i \left( \cdot, t \right)$ and $\mathrm{dgm}_p~u_i^\prime \left( \cdot, t \right)$, obtained from $u_i \left( \cdot, t \right)$ and $u_i^\prime \left( \cdot, t \right)$, can be controlled in terms of the model parameters $D, \theta$ and $D^\prime, \theta^\prime$. More precisely, we establish the following Lipschitz continuity.

\begin{thm}\label{thm:main-theorem}
  Let $1 \leq i \leq n$, and let $p$ be a positive integer. Suppose that, for all $0 < t \leq T$, there exist constants $L_1, L_2, L_3 \in \mathbb{R}$ independent of $D, D^\prime$ and $\theta, \theta^\prime$, such that for all $x \in \Omega$ and $0 < t \leq T$,
  \begin{align}
    \left\| R_i \left( U \left( \cdot, t \right); \theta \right) - R_i \left( U^\prime \left( \cdot, t \right); \theta^\prime \right) \right\|_\infty
    &\leq L_1 \left\| \left( U \left( \cdot, t \right) \right)- \left( U^\prime \left( \cdot, t \right) \right)  \right\|_\infty\label{eq:reaction-lip}
    + L_2 \left\| \theta - \theta^\prime \right\|_\infty\\
    \left\| R_i \left( U \left( \cdot, t \right); \theta \right) \right\|_\infty
    &\leq L_3, \label{eq:reaction-bound}
    ~\left\| R_i \left( U^\prime \left( \cdot, t \right); \theta^\prime \right) \right\|_\infty
    \leq L_3,
  \end{align}
  then, for all $0 < t \leq T$, there exist constants $M_1, M_2 \in \mathbb{R}$, independent of $D, D^\prime$ and $\theta, \theta^\prime$, such that,
  \begin{align}\label{eq:inequality-main-theorem}
    d_B \left( \mathrm{dgm}_p u_i \left( \cdot, t \right), \mathrm{dgm}_p u_i^\prime \left( \cdot, t \right) \right) \leq M_1 \left\| D - D^\prime \right\|_\infty + M_2 \left\| \theta - \theta^\prime \right\|_\infty.
  \end{align}
\end{thm}

This theorem shows that if the differences between the model parameters, $\left\| D - D^\prime \right\|_\infty$ and $\left\| \theta - \theta^\prime \right\|_\infty$ are sufficiently small, then the bottleneck distance $d_B \left( \mathrm{dgm}_p~u_i, \mathrm{dgm}_p~u_i^\prime \right)$ is also necessarily small.

\subsection{Proof of main theorem}

The proof of Theorem \ref{thm:main-theorem} is based on Theorem \ref{thm:stability}. In order to apply Theorem \ref{thm:stability}, we first need an estimate for $\left\| u_i \left( \cdot, t \right) - u_i^\prime \left( \cdot, t \right) \right\|_\infty$. To this end, we prepare several auxiliary lemmas.

\begin{lem}\label{lem:contraction}
  Let $\lambda \in \Lambda$ and $0 < t \leq T$. Then for any $u \in C_{\mathrm{per}} \left( \Omega \right)$, we have
  \begin{align*}
    \left\| H_{\lambda} \left( t \right) u \right\|_\infty \leq  \left\| u \right\|_\infty.
  \end{align*}
\end{lem}

\begin{proof}
  By the definition of $H_{\lambda} \left( t \right)$ , for $0 < t \leq T$, we have
  \begin{align*}
    \left\| H_{\lambda} \left( t \right) u \right\|_\infty
    & \leq \left\| K_{\lambda, t} * u \right\|_{\infty}\\
    & \leq \left\| K_{\lambda, t} \right\|_{L^1} \left\| u \right\|_{\infty}\\
    &= \left\| u \right\|_{\infty}.
  \end{align*}
\end{proof}

\begin{lem}\label{lem:heat-kernel-lip}
  For any $0 < t \leq T$ and $\lambda, \lambda^\prime \in \Lambda$, we have
  \begin{align*}
    \left\| K_{\lambda, t} - K_{\lambda^\prime, t} \right\|_{L^1} \leq \dfrac{d}{\inf_{\tau \in \Lambda} \tau} \left| \lambda - \lambda^\prime \right|.
  \end{align*}
  Moreover, for any $u \in C_{\mathrm{per}} \left( \Omega \right)$, we have
  \begin{align*}
    \left\| \left( H_{\lambda} \left( t \right) - H_{\lambda^\prime} \left( t \right) \right) u \right\|_{\infty} \leq \dfrac{d}{\inf_{\tau \in \Lambda} \tau} \left| \lambda - \lambda^\prime \right| \left\| u \right\|_\infty.
  \end{align*}
\end{lem}

\begin{proof}
  For any $0 < t \leq T$ and $x \in \mathbb{R}^d$
  \begin{align*}
    \dfrac{\partial}{\partial \lambda} g_{\lambda, t} \left( x \right)
    &= - \dfrac{d}{2} \dfrac{1}{\left( 4 \pi \lambda t \right)^{d / 2 + 1}} 4 \pi t \exp \left( - \dfrac{ \left\| x \right\|^2 }{ 4 \lambda t } \right) + \dfrac{1}{\left( 4 \pi \lambda t \right)^{d / 2}} \exp \left( - \dfrac{ \left\| x \right\|^2 }{ 4 \lambda t } \right) \dfrac{ \left\| x \right\|^2 }{ 4 \lambda^2 t }\\
    &= \left( - \dfrac{ d }{ 2 \lambda } + \dfrac{ \left\| x \right\|^2 }{ 4 \lambda^2 t } \right) g_{\lambda, t} \left( x \right).
  \end{align*}
  Then, 
  \begin{align*}
    \left\| \dfrac{\partial}{\partial \lambda} K_{\lambda, t} \right\|_{L^1}
    &= \left\| \dfrac{\partial}{\partial \lambda} \sum_{k \in \mathbb{Z}^d} g_{\lambda, t} \left( x + k \right) \right\|_{L^1}\\
    % &= \left\| \sum_{k \in \mathbb{Z}^d} \dfrac{\partial}{\partial \lambda} g_{\lambda, t} \left( x + k \right) \right\|_{L^1}\\
    & \leq \sum_{k \in \mathbb{Z}^d} \left\| \dfrac{\partial}{\partial \lambda} g_{\lambda, t} \left( x + k \right) \right\|_{L^1}\\
    &= \sum_{k \in \mathbb{Z}^d} \int_{\left[ 0, 1 \right]^d} \left| \dfrac{\partial}{\partial \lambda} g_{\lambda, t} \left( x + k \right) \right| dx\\
    &= \int_{\mathbb{R}^d} \left| \dfrac{\partial}{\partial \lambda} g_{\lambda, t} \left( x \right) \right| dx\\
    &\leq \int_{\mathbb{R}^d} \left( \dfrac{d}{2 \lambda} + \dfrac{\left\| x \right\|^2}{4 \lambda^2 t} \right) g_{\lambda, t} \left( x \right) dx\\
    % &= \dfrac{d}{2 \lambda} \int_{\mathbb{R}^d} g_{\lambda, t} \left( x \right) dx + \dfrac{1}{4 \lambda^2 t} \int_{\mathbb{R}^d} \left\| x \right\|^2 g_{\lambda, t} \left( x \right) dx\\
    &= \dfrac{d}{2 \lambda} + \dfrac{1}{4 \lambda^2 t} 2d \lambda t\\
    &= \dfrac{d}{\lambda}
  \end{align*}
  
  Next, for any $\lambda, \lambda^\prime \in \Lambda$,
  \begin{align*}
    K_{\lambda, t} \left( x \right) - K_{\lambda^\prime, t} \left( x \right)
    &= \sum_{k \in \mathbb{Z}^d} \left( g_{\lambda, t} \left( x + k \right) - g_{\lambda^\prime, t} \left( x + k \right) \right)\\
    &= \sum_{k \in \mathbb{Z}^d} \int_{\lambda^\prime}^{\lambda} \dfrac{\partial}{\partial \tau} g_{\tau, t} \left( x + k \right) d \tau \\
    &= \int_{\lambda^\prime}^\lambda \sum_{k \in \mathbb{Z}^d} \dfrac{\partial}{\partial \tau} g_{\tau, t} \left( x + k \right) d \tau\\
    &= \int_{\lambda^\prime}^\lambda \dfrac{\partial}{\partial \tau} K_{\tau, t} \left( x \right) d \tau.
  \end{align*}
  Hence, we can get
  \begin{align*}
    \left\| K_{\lambda, t} - K_{\lambda^\prime, t} \right\|_{L^1}
    &= \int_{\left[ 0, 1 \right]^d} \left| \int_{\lambda^\prime}^\lambda \dfrac{\partial}{\partial \tau} K_{\tau, t} \left( x \right) d \tau \right| dx\\
    &\leq \int_{\left[ 0, 1 \right]^d} \int_{\lambda^\prime}^\lambda \left| \dfrac{\partial}{\partial \tau} K_{\tau, t} \left( x \right) \right| d \tau dx\\
    &= \int_{\lambda^\prime}^\lambda \left\| \dfrac{\partial}{\partial \tau} K_{\tau, t} \left( x \right) \right\|_{L^1} d\tau\\
    &\leq \sup_{\tau \in \Lambda} \left\| \dfrac{\partial}{\partial \tau} K_{\tau, t} \left( x \right)  \right\|_{L^1} \left| \lambda - \lambda^\prime \right|\\
    &\leq \sup_{\tau \in \Lambda} \dfrac{d}{\tau} \left| \lambda - 
    \lambda^\prime \right|\\
    &= \dfrac{d}{\inf_{\tau \in \Lambda} \tau} \left| \lambda - \lambda^\prime \right|.
  \end{align*}
  Finally, we have
  \begin{align*}
    \left\| \left( H_{\lambda} \left( t \right) - H_{\lambda^\prime} \left( t \right) \right) u \right\|_{\infty}
    &\leq \left\| K_{\lambda, t} - K_{\lambda^\prime, t} \right\|_{L^1} \left\| u \right\|_\infty\\
    &\leq \dfrac{d}{\inf_{\tau \in \Lambda} \tau} \left| \lambda - \lambda^\prime \right| \left\| u \right\|_\infty.
  \end{align*}
\end{proof}

Combining the above estimates, we obtain the following bound for $\left\| u_i \left( \cdot, t \right) - u_i^\prime \left( \cdot, t \right) \right\|_\infty$.

\begin{prop}\label{prop:bound-for-solution-diff}
  For all $0 < t \leq T$, there exist constants $M_1, M_2 \in \mathbb{R}$, independent of $D, D^\prime$ and $\theta, \theta^\prime$, such that
  \begin{align*}
    \left\| U \left( \cdot, t \right) - U^\prime \left( \cdot, t \right) \right\|_\infty
    \leq M_1 \left\| D - D^\prime \right\|_\infty + M_2 \left\| \theta - \theta^\prime \right\|_\infty.
  \end{align*}
\end{prop}

\begin{proof}
  By the arguments in the Preliminary section, the classical solutions of \eqref{eq:reaction-diffusion-equations-normal} and \eqref{eq:reaction-diffusion-equations-prime} are given by
  \begin{align*}
    u_i \left( \cdot, t \right) &= H_{\lambda_i} \left( t \right) \tilde{u}_i \left( \cdot \right) + \int_0^t H_{\lambda_i} \left( t - s \right) R_i \left( u_1 \left( \cdot, s \right), \dots, u_n \left( \cdot, s \right); \theta \right) ds, \\
    u_i^\prime \left( \cdot, t \right) &= H_{\lambda_i^\prime} \left( t \right) \tilde{u}_i \left( \cdot \right) + \int_0^t H_{\lambda_i^\prime} \left( t - s \right) R_i \left( u_1^\prime \left( \cdot, s \right), \dots, u_n^\prime \left( \cdot, s \right); \theta^\prime \right) ds.
  \end{align*}
  Hence, we can get
  \begin{align*}
    \left\| u_i \left( \cdot, t \right) - u_i^\prime \left( \cdot, t \right) \right\|_\infty
    &\leq \left\| \left( H_{\lambda_i} \left( t \right) - H_{\lambda_i^\prime} \left( t \right) \right) \tilde{u}_i \left( \cdot \right) \right\|_\infty\\
    &\hspace{1cm} + \left\| \int_0^t \left( H_{\lambda_i} \left( t - s \right) R_i \left( U \left( \cdot, s \right); \theta \right) - H_{\lambda_i^\prime} \left( t - s \right) R_i \left( U \left( \cdot, s \right); \theta^\prime \right) \right) \right\|_\infty\\
    &\leq \left\| \left( H_{\lambda_i} \left( t \right) - H_{\lambda_i^\prime} \left( t \right) \right) \tilde{u}_i \left( \cdot \right) \right\|_\infty \\
    &\hspace{1cm} + \left\| \int_0^t \left( H_{\lambda_i} \left( t - s \right) - H_{\lambda_i^\prime} \left( t - s \right) \right) R_i \left( U \left( \cdot, s \right); \theta \right) ds \right\|_\infty \\
    &\hspace{1cm} + \left\| \int_0^t H_{\lambda_i} \left( t - s \right) \left( R_i \left( U \left( \cdot, s \right); \theta \right) - R_i \left( U^\prime \left( \cdot, s \right); \theta^\prime \right) \right) ds \right\|_\infty.
  \end{align*}
  Define $E_{i, 1}$, $E_{i, 2}$, and $E_{i, 3}$ by
  \begin{align*}
    E_{i, 1} &= \left\| \left( H_{\lambda_i} \left( t \right) - H_{\lambda_i^\prime} \left( t \right) \right) \tilde{u}_i \left( \cdot \right) \right\|_\infty, \\
    E_{i, 2} &= \left\| \int_0^t \left( H_{\lambda_i} \left( t - s \right) - H_{\lambda_i^\prime} \left( t - s \right) \right) R_i \left( U \left( \cdot, s \right); \theta \right) ds \right\|_\infty, \\
    E_{i, 3} &= \left\| \int_0^t H_{\lambda_i} \left( t - s \right) \left( R_i \left( U \left( \cdot, s \right); \theta \right) - R_i \left( U^\prime \left( \cdot, s \right); \theta^\prime \right) \right) ds \right\|_\infty,
  \end{align*}
  then, by estimating $E_{i, 1}$, $E_{i, 2}$, and $E_{i, 3}$, we obtain the desired bound for $\left\| u_i \left( \cdot, t \right) - u_i^\prime \left( \cdot, t \right) \right\|_\infty$. We now proceed to estimate $E_{i, 1}, E_{i, 2}, E_{i, 3}$.

  First, by Lemma \ref{lem:heat-kernel-lip},
  \begin{align*}
    E_{i, 1}
    &= \left\| \left( H_{\lambda_i} \left( t \right) - H_{\lambda_i^\prime} \left( t \right) \right) \tilde{u}_i \left( \cdot \right) \right\|_\infty \\
    &\leq \dfrac{d}{\inf_{\tau \in \Lambda} \tau} \left| \lambda_i - \lambda_i^\prime \right| \left\| \tilde{u}_i \left( \cdot \right) \right\|_\infty \\
    &\leq \dfrac{d}{\inf_{\tau \in \Lambda} \tau} \left| \lambda_i - \lambda_i^\prime \right| \left\|  \right\|_\infty. \\
  \end{align*}
  Next, by \eqref{eq:reaction-bound} and Lemma \ref{lem:heat-kernel-lip},
  \begin{align*}
    E_{i, 2}
    &= \left\| \int_0^t \left( H_{\lambda_i} \left( t - s \right) - H_{\lambda_i^\prime} \left( t - s \right) \right) R_i \left( U \left( \cdot, s \right); \theta \right) ds \right\|_\infty \\
    &\leq \int_0^t \left\| \left( H_{\lambda_i} \left( t - s \right) - H_{\lambda_i^\prime} \left( t - s \right) \right) R_i \left( U \left( \cdot, s \right); \theta \right) \right\|_\infty ds \\
    &\leq \dfrac{d}{\inf_{\tau \in \Lambda} \tau} \left| \lambda_i - \lambda_i^\prime \right| L_3 t.
  \end{align*}
  Finally, by \eqref{eq:reaction-lip} and Lemma \ref{lem:contraction},
  \begin{align*}
    E_{i, 3}
    &= \left\| \int_0^t H_{\lambda_i} \left( t - s \right) \left( R_i \left( U \left( \cdot, s \right); \theta \right) - R_i \left( U^\prime \left( \cdot, s \right); \theta^\prime \right) \right) ds \right\|_\infty\\
    &\leq \int_0^t \left\| H_{\lambda_i} \left( t - s \right) \left( R_i \left( U \left( \cdot, s \right); \theta \right) - R_i \left( U^\prime \left( \cdot, s \right); \theta^\prime \right) \right) \right\|_\infty ds \\
    &\leq \int_0^t \left\| \left( R_i \left( U \left( \cdot, s \right); \theta \right) - R_i \left( U^\prime \left( \cdot, s \right); \theta^\prime \right) \right) \right\|_\infty ds \\
    &\leq L_1 \int_0^t \left\| U \left( \cdot, s \right) - U^\prime \left( \cdot, s \right) \right\|_\infty ds + L_2 t \left\| \theta - \theta^\prime \right\|_\infty.
  \end{align*}

  Combining these estimates, we obtain
  \begin{align*}
    \left\| u_i \left( \cdot, t \right) - u_i^\prime \left( \cdot, t \right) \right\|_\infty
    &\leq E_{i, 1} + E_{i, 2} + E_{i, 3}\\
    &\leq \dfrac{d}{\inf_{\tau \in \Lambda} \tau} \left( \left\| \tilde{u}_i \right\|_\infty + L_3 t \right) \left| \lambda_i - \lambda_i^\prime \right| + L_2 t \left\| \theta - \theta^\prime \right\|_\infty + L_1 \int_0^t \left\| U \left( \cdot, s \right) - U^\prime \left( \cdot, s \right) \right\|_\infty ds.
  \end{align*}
  Therefore, we have
  \begin{align*}
    \left\| U \left( \cdot, t \right) - U^\prime \left( \cdot, t \right) \right\|_\infty
    &\leq \dfrac{d}{\inf_{\tau \in \Lambda} \tau} \left( \left\| \tilde{u}_i \right\|_\infty + L_3 t \right) \left\| D - D^\prime \right\|_\infty + L_2 t \left\| \theta - \theta^\prime \right\|_\infty + L_1 \int_0^t \left\| U \left( \cdot, s \right) - U^\prime \left( \cdot, s \right) \right\|_\infty ds.
  \end{align*}
  By Gronwall's inequality \cite{henry2006geometric}, we obtain
  \begin{align*}
    \left\| U \left( \cdot, t \right) - U^\prime \left( \cdot, t \right) \right\|_\infty
    &\leq \left\{ \dfrac{d}{\inf_{\tau \in \Lambda} \tau} \left( \left\| \tilde{u}_i \right\|_\infty + L_3 t \right) \left\| D - D^\prime \right\|_\infty + L_2 t \left\| \theta - \theta^\prime \right\|_\infty \right\} e^{L_1 t}.
  \end{align*}
  By setting
  \begin{align*}
    M_1 &= \dfrac{d}{\inf_{\tau \in \Lambda} \tau} \left( \left\| \tilde{U} \right\|_\infty + L_3 t \right) e^{L_1 t}, \\
    M_2 &= L_2 t e^{L_1 t},
  \end{align*}
  we obtain
  \begin{align*}
    \left\| U \left( \cdot, t \right) - U^\prime \left( \cdot, t \right) \right\|_\infty
    \leq M_1 \left\| D - D^\prime \right\|_\infty + M_2 \left\| \theta - \theta^\prime \right\|_\infty.
  \end{align*}
\end{proof}

Combining Proposition \ref{prop:bound-for-solution-diff} with Theorem \ref{thm:stability}, we can now complete the proof of Theorem \ref{thm:main-theorem}.
\begin{proof}[Proof of Theorem \ref{thm:main-theorem}]
  For any $1 \leq i \leq n$, Proposition \ref{prop:bound-for-solution-diff} yields
  \begin{align*}
    \left\| u_i \left( \cdot, t \right) - u_i^\prime \left( \cdot, t \right) \right\|
    &\leq \left\| U \left( \cdot, t \right) - U^\prime \left( \cdot, t \right) \right\|_\infty \\
    &\leq M_1 \left\| D - D^\prime \right\|_\infty + M_2 \left\| \theta - \theta^\prime \right\|_\infty.
  \end{align*}
  Moreover, since $\Omega$ is triangulable and $u_i \left( \cdot, t \right)$ and $u^\prime \left( \cdot, t \right)$ are continuous functions on $\Omega$, by Theorem \ref{thm:q-tame-of-continuous} and Theorem \ref{thm:stability}, we have
  \begin{align*}
    d_B \left( \mathrm{dgm}_p~u_i \left( \cdot, t \right), \mathrm{dgm}_p~u_i^\prime \left( \cdot, t \right) \right) \leq \left\| u_i \left( \cdot, t \right) - u_i^\prime \left( \cdot, t \right) \right\|_\infty.
  \end{align*}
  Therefore, 
  \begin{align*}
     d_B \left( \mathrm{dgm}_p~u_i \left( \cdot, t \right), \mathrm{dgm}_p~u_i^\prime \left( \cdot, t \right) \right) \leq M_1 \left\| D - D^\prime \right\|_\infty + M_2 \left\| \theta - \theta^\prime \right\|_\infty
  \end{align*}
  which completes the proof.
\end{proof}