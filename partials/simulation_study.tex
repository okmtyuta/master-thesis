\section{Simulation study}\label{sec:simulation-study}

% Section \ref{sec:example}では，Gray--Scottモデルが生成するTuringパターンに対して不等式\eqref{eq:main-theorem-gs}が成り立つことを示した。この不等式は，反応拡散方程式系のパラメータを微小に変化させても，対応するパーシステンス図が大きくは変化しないこと（安定性）を意味する。本Sectionでは，この理論的結果を数値シミュレーションにより検証する。まず，計算設定と以降で用いる記法をまとめる。

% Section \ref{sec:method}およびSection \ref{sec:example}の理論解析では特異ホモロジーを用いたが，特異ホモロジーは数値計算には適さない。そこで本Sectionでは，立方複体にもとづく立方的ホモロジーを用いてパーシステントホモロジーを計算する。この変更はTheorem \ref{thm:main-theorem}の結論に本質的な影響を与えない。立方的ホモロジーの詳細は\cite{kaczynski2006computational}を参照されたい。また，パーシステントホモロジーの計算にはPythonライブラリGUDHI \cite{gudhi:urm}を用いる。

% Gray--Scottモデルでは，反応項のパラメータ$\theta=\left( F, k \right)$を主要なモデルパラメータとして扱うことが多い。本Sectionでもこれに従い，拡散係数（反応係数）を$\lambda_1 = 0.1$および$\lambda_2 = 0.05$に固定し，$\theta$のみを変化させる。$\theta$を与えたときのGray--Scottモデル\eqref{eq:general-gray-scott}の解を$\left( u_1,u_2 \right) = \left( u_{1,\theta},u_{2,\theta} \right)$と書く。以下では，$u_{1, \theta}$のみに注目する。

In Section \ref{sec:example}, we showed that inequality \eqref{eq:main-theorem-gs} holds for Turing patterns generated by the Gray--Scott model. This inequality implies the stability that even if the parameters of a reaction--diffusion system are perturbed slightly, the corresponding persistence diagrams do not change significantly. In this section, we verify this theoretical result by numerical simulations. First, we summarize the computational setting and the notation used throughout what follows.

In the theoretical analysis in Section \ref{sec:method} and Section \ref{sec:example}, we used singular homology; however, singular homology is not suitable for numerical computation. Therefore, in this section, we compute persistent homology using cubical homology based on cubical complexes. This modification does not essentially affect the conclusion of Theorem \ref{thm:main-theorem}. For details on cubical homology, see \cite{kaczynski2006computational}. Moreover, we use the Python library GUDHI \cite{gudhi:urm} to compute persistent homology.

In the Gray--Scott model, the parameters of the reaction terms $\theta=\left( F,k \right)$ are often treated as the primary model parameters. Following this convention, in this section we fix the diffusion coefficients at $\lambda_1 = 0.1$ and $\lambda_2 = 0.05$, and vary only $\theta$. Given $\theta$, we write the solution of the Gray--Scott model \eqref{eq:general-gray-scott} as $\left( u_1,u_2 \right) = \left( u_{1,\theta},u_{2,\theta} \right)$. In what follows, to facilitate a clearer comparison of the experimental results, we present only the simulation results for $u_{1, \theta}$. Similar results also hold for $u_{2, \theta}$.


\begin{table}[h]
 \begin{center}
  \caption{Parameters considered in the simulation. $\theta_1$ and $\theta_1^\prime$, as well as $\theta_2$ and $\theta_2^\prime$, are similar parameter settings.}
  \begin{tabular}{c|cccc}
    & $\theta_1$ & $\theta_1^\prime$ & $\theta_2$ & $\theta_2^\prime$  \\ \hline
    $F$ & 0.02000    & 0.02001           & 0.02500    & 0.02501         \\
    $k$ & 0.05750    & 0.05751           & 0.05500    & 0.05501      
  \end{tabular}
  \label{tab:parameters}
 \end{center}
\end{table}

We perform simulations in a two-dimensional spatial domain $\left( d = 2 \right)$ and consider the time interval $0 \leq t \leq T = 3000$. For the initial condition, we use $\tilde{u_1},\tilde{u_2}$ shown in Figure \ref{fig:initial-condition}. In addition, we consider the four parameter settings $\theta_1, \theta_1^\prime, \theta_2,\theta_2^\prime$ listed in Table \ref{tab:parameters}. As shown in Figure \ref{fig:u-theta}, both $\theta_1$ and $\theta_1^\prime$ generate spot patterns and are similar to each other. Similarly, both $\theta_2$ and $\theta_2^\prime$ generate labyrinth patterns and are similar to each other. Furthermore, so as to include these parameter settings, we define the parameter search regions as $\mathcal{F}=\left[ 0.0100,0.0300 \right]$ and $\mathcal{K}=\left[ 0.0450,0.0600 \right]$.

First, for the parameter pairs $\left( \mu, \nu \right) \in \Set{ \left( \theta_1, \theta_1^\prime \right), \left( \theta_2, \theta_2^\prime \right), \left( \theta_1, \theta_2 \right) }$ and for $p = 0, 1$, we numerically computed $d_B \left( \mathrm{dgm}_p~u_{1, \mu}, \mathrm{dgm}_p~u_{1, \nu} \right)$, $\left\| u_{1, \mu} - u_{1, \nu} \right\|_\infty$, and $M_2 \left( t \right) \left\| \mu - \nu \right\|_{\infty}$, and examined whether inequality \eqref{eq:main-theorem-gs}, namely
\begin{align*}
  d_B \left( \mathrm{dgm}_p~u_{1, \mu}, \mathrm{dgm}_p~u_{1, \nu} \right) \leq \left\| u_{1, \mu} - u_{1, \nu} \right\|_\infty \leq M_2 \left( t \right)\left\| \mu - \nu \right\|_{\infty}
\end{align*}
holds. The results are shown in Figure \ref{fig:simulation-for-inequality}.  From Figure \ref{fig:simulation-for-inequality}, we see that inequality \eqref{eq:main-theorem-gs} holds for each parameter pair $\left( \mu, \nu \right).$ On the other hand, as the time $t$ increases, $M_2 \left( t \right)\left\| \mu - \nu \right\|_{\infty}$ becomes very large, indicating that \eqref{eq:main-theorem-gs} provides a loose bound. This is because $M_2 \left( t \right)$ grows exponentially with respect to time $t$. Therefore, when $t$ is large, the usefulness of inequality \eqref{eq:main-theorem-gs} deteriorates significantly.

Next, we directly compare the persistence diagrams themselves and, through visualization, verify that when the difference between parameters is small, the change in the diagram's shape is also small. Figure \ref{fig:theta-time-series} shows the patterns generated by each parameter $\theta \in \Set{ \theta_1, \theta_1^\prime, \theta_2, \theta_2^\prime }$ and the temporal evolution of their persistence diagrams. From Figure \ref{fig:theta-time-series}, for the parameter pairs $\left( \theta_1, \theta_1^\prime \right)$ and $\left( \theta_2, \theta_2^\prime \right)$, the corresponding point configurations in the persistence diagrams are highly similar to each other, indicating visually that small perturbations in the parameters lead to only small changes in the persistence diagrams.

\input{partials/simulation_study_result1.tex}

\input{partials/simulation_study_result2.tex}

% シミュレーションは2次元空間（$d = 2$）で行い，時間区間は$0 \leq t \leq T = 3000$とする。初期条件にはFigure \ref{fig:initial-condition}に示す$\tilde{u_1},\tilde{u_2}$を用いる。また，実験ではTable \ref{tab:parameters}に示す4つのパラメータ$\theta_1, \theta_1^\prime, \theta_2,\theta_2^\prime$を取り上げる。Figure \ref{fig:u-theta}に示すように，$\theta_1$と$\theta_1^\prime$はいずれもspotパターンを生成し，互いに類似している。同様に，$\theta_2$と$\theta_2^\prime$はいずれもlabyrinthパターンを生成し，互いに類似している。さらに，これらのパラメータを含むように，探索するパラメータ領域を$\mathcal{F}=[0.0100,0.0300]$および$\mathcal{K}=[0.0450,0.0600]$と定める。

% まずは，パラメータの組み合わせ$\left( \mu, \nu \right) \in \Set{ \left( \theta_1, \theta_1^\prime \right), \left( \theta_2, \theta_2^\prime \right), \left( \theta_1, \theta_2 \right) }$および$p = 0, 1$に対して，$d_B \left( \mathrm{dgm}_p~u_{1, \mu}, \mathrm{dgm}_p~u_{1, \nu} \right)$，$\left\| u_{1, \mu} - u_{1, \nu} \right\|_\infty$および$M_2\left\| \mu - \nu \right\|_{\infty}$を数値的に計算し，不等式\eqref{eq:main-theorem-gs}，すなわち，
% \begin{align*}
%   d_B \left( \mathrm{dgm}_p~u_{1, \mu}, \mathrm{dgm}_p~u_{1, \nu} \right) \leq \left\| u_{1, \mu} - u_{1, \nu} \right\|_\infty \leq M_2\left\| \mu - \nu \right\|_{\infty}
% \end{align*}
% が成り立つかを検証した。この結果をFigure \ref{fig:simulation-for-inequality}に示す。Figure \ref{fig:simulation-for-inequality}から，各パラメータの組み合わせ$\left( \mu, \nu \right)$に対して，不等式\eqref{eq:main-theorem-gs}が成り立っていることがわかる。一方で，時間$t$が大きくなるにつれて，$M_2\left\| \mu - \nu \right\|_{\infty}$が非常に大きくなり，\eqref{eq:main-theorem-gs}が緩い不等式になっていることがわかる。これは，$M_2$が時間$t$に対して，指数的に大きくなるからである。したがって，時間$t$が大きい状況では，不等式\eqref{eq:main-theorem-gs}の有用性は大きく低下することもわかる。

% 不等式\eqref{eq:main-theorem-gs}をシミュレーションによって検証した結果をFigure \ref{fig:simulation-for-inequality}に示す。図より，すべてのパラメータの組み合わせに対して，不等式\eqref{eq:main-theorem-gs}が数値的に成立していることが確認できる。一方で，各パラメータの組み合わせ$\left( \mu, \nu \right) = \left( \theta_1, \theta_1^\prime \right)$時間$t$の増加に伴い，

% 次に，パーシステンス図そのものを比較し，パラメータ差が小さい場合には図の形状の変化も小さいことを可視化によって確認する。Figure \ref{fig:theta-time-series}には，各パラメータ$\theta \in \Set{ \theta_1, \theta_1^\prime, \theta_2, \theta_2^\prime }$が生成するパターンとそのパーシステンス図の時間変化を示している。Figure \ref{fig:theta-time-series}より，パラメータの組み合わせ$\left( \theta_1, \theta_1^\prime \right)$および$\left( \theta_2, \theta_2^\prime \right)$に対しては，対応するパーシステンス図の点の配置は互いに良く類似しており，パラメータの微小な変化に対してパーシステンス図の変化も微小であることが視覚的に確認できる。

% 不等式\eqref{eq:main-theorem-gs}をシミュレーションによって検証した結果を図xxxに示す。図より，検討したすべてのパラメータに対して左辺は右辺以下に収まっており，不等式\eqref{eq:main-theorem-gs}が数値的に支持されることが確認できる。さらに，時間$t$の増加に伴い右辺が大きくなるため，上界は次第に緩くなる傾向が見られる。したがって，不等式\eqref{eq:main-theorem-gs}はすべての$0 \leq t \leq T$で成立する一方，長時間領域では距離の評価としての有用性が低下する。

% Section \ref{sec:example}では，Gray--Scottモデルが生成するTuringパターンに対して，不等式\eqref{eq:main-theorem-gs}が成立することを示した。さらに，この不等式は，反応拡散方程式系のパラメータをわずかに摂動させたときにもパーシステンス図が大きく変化しないという安定性が存在することが示唆される。本節では，これらの結果を数値シミュレーションにより検証する。以下では，計算条件と記法をまとめる。

% Section \ref{sec:method}およびSection \ref{sec:example}の理論解析では特異ホモロジーに基づいて議論を行ったが，特異ホモロジーは数値計算に直接適用しにくい。そこで本節の計算では，立方的複体に基づく立方的ホモロジーを用いてパーシステントホモロジーを評価する。なお，ホモロジーの選択を立方的ホモロジーに置き換えても，Theorem \ref{thm:main-theorem}で得られる結論の本質は損なわれない。立方的ホモロジーの詳細は\cite{kaczynski2006computational}を参照されたい。また，パーシステントホモロジーの計算にはPythonライブラリGUDHI \cite{gudhi:urm}を用いる。

% Gray--Scottモデルの解析においては，反応項のパラメータ$\theta = \left( F, k \right)$のみをモデルパラメータとして扱うことが多い。本シミュレーションでも，反応係数を$\lambda_1 = 0.1$および$\lambda_2 = 0.05$で固定し，$\theta$のみを変化させる。パラメータ$\theta$に対するGray--Scottモデルの解を$\left( u_{1, \theta}, u_{2, \theta} \right)$と表し，特に$u_{1, \theta}$に注目することにする。また，空間の次元は$d = 2$とし，シミュレーションの時間区間は$0 \leq t \leq T$とする。さらに，表xには，シミュレーションで注目するパラメータを示す。パラメータ$\theta_1, \theta_2, \theta_3$をすべて含むように，パラメータ空間は$\mathcal{F} = \left[ 0.0100, 0.0300 \right]$および$\mathcal{K} = \left[ 0.0450, 0.0600 \right]$と定める。

% 不等式\eqref{eq:main-theorem-gs}をシミュレーションによって検証した結果を図xxxに示す。図より，検討したすべてのパラメータに対して左辺は右辺以下に収まっており，不等式\eqref{eq:main-theorem-gs}が数値的に支持されることが確認できる。さらに，時間$t$の増加に伴い右辺が大きくなるため，上界は次第に緩くなる傾向が見られる。したがって，不等式\eqref{eq:main-theorem-gs}はすべての$0 \leq t \leq T$で成立する一方，長時間領域では距離の評価としての有用性が低下する。

% 図yは，2つのパラメータ$\theta, \theta^\prime$に対して得られるパーシステンス図の間のボトルネック距離をヒートマップにより可視化したものである。対角成分$\theta = \theta^\prime$ではボトルネック距離が$0$となり，対角線から離れるにつれてボトルネック距離が増大する傾向が見られる。したがって，パラメータの差$\left\| \theta - \theta^\prime \right\|_\infty$が小さいほど，対応するパーシステンス図の差も小さく，ボトルネック距離は小さく保たれることがわかる。

% 次に，パーシステンス図そのものを比較し，パラメータ差が小さい場合には図の形状の変化も小さいことを可視化によって確認する。図zには，各パラメータ$\theta$とその微小な摂動$\theta^\prime$に対するパーシステンス図を示している。図zより，パラメータの差$\left\| \theta - \theta^\prime \right\|_\infty$が小さければ，対応するパーシステンス図は互いに良く類似しており，パラメータの微小な変化に対してパーシステンス図の変化も微小であることが視覚的に確認できる。

% 以上の数値シミュレーションにより，Gray--Scottモデルから得られるTuringパターンに対して不等式\eqref{eq:main-theorem-gs}が数値的に成立することが確認された。また，ヒートマップおよびパーシステンス図の直接比較から，パラメータ差が小さい場合にはボトルネック距離ならびにパーシステンス図の変化も小さく保たれることが観察され，理論が示すパーシステンス図の安定性が実験的に支持された。さらに，時間$t$の増加に伴い上界が増大して評価が緩くなる傾向も確認され，長時間領域では不等式による評価の有用性が低下することが示唆された。

% In Section \ref{sec:example}, we showed that inequality \eqref{eq:main-theorem-gs} holds for Turing patterns generated by the Gray--Scott model. Moreover, this inequality suggests a stability property: even when the parameters of the reaction--diffusion system are perturbed slightly, the persistence diagram does not change significantly. In this section, we verify these results numerically via simulations. We first summarize the computational settings and notation.

% The theoretical analyses in Sections \ref{sec:method} and \ref{sec:example} are based on singular homology; however, singular homology is not well suited for direct numerical computation. Therefore, in this section we evaluate persistent homology using cubical homology based on cubical complexes. Note that replacing singular homology with cubical homology does not affect the essential conclusions of Theorem \ref{thm:main-theorem}. For details on cubical homology, see \cite{kaczynski2006computational}. Persistent homology is computed using the Python library GUDHI \cite{gudhi:urm}.

% In analyses of the Gray--Scott model, it is common to treat only the reaction-term parameters $\theta = \left( F, k \right)$ as model parameters. In our simulations, we likewise fix the reaction coefficients at $\lambda_1 = 0.10$ and $\lambda_2 = 0.05$, and vary only $\theta$. We denote the solution of the Gray--Scott model for a parameter $\theta$ by $\left( u_{1, \theta},u_{2, \theta} \right)$, and focus in particular on $u_{1, \theta}$. We set the spatial dimension to $d = 2$ and consider the time interval $0 \leq t \leq T = 4000$. Table \ref{tab:parameters} lists the parameters of interest in the simulations. To include $\theta_1,\theta_2,\theta_3$, we define the parameter ranges as $\mathcal{F}=\left[ 0.0100,0.0300 \right]$ and $\mathcal{K}=\left[ 0.0500,0.0600 \right]$.

% \begin{figure}[h]
%   \centering
%   \includegraphics[width=0.7\linewidth]{figures/time_series-1-2.png}

%   \caption{Results of numerical simulations verifying the validity of inequality \eqref{eq:main-theorem-gs} for the parameter pair $\left( \theta_1, \theta_2 \right)$. The top row shows the behavior over the time interval $0 \leq t \leq 3000$, while the bottom row provides a magnified view over $0 \leq t \leq 20$ to examine the early-time behavior in detail. Each quantity is plotted on a logarithmic scale. To avoid the logarithmic divergence near zero, when $x$ is close to $0$, we add $\varepsilon = 1.0 \times 10^{-12}$ before applying the log transform and compute $\log \left( x + \varepsilon \right)$. The constant $L_4$ used in the computation of $M_1$ was taken to be its numerically evaluated value.}
%   \label{fig:exp1}
%   % \caption{各パラメータ組合せに対して，不等式\eqref{eq:main-theorem-gs}の成立を数値シミュレーションにより検証した結果。上段は時間区間 $0 \leq t \leq 3000$ における挙動を示し，下段は初期の挙動を詳細に見るために $0 \leq t \leq 20$ を拡大して表示している。ゼロ近傍での対数発散を避けるため，$x$が$0$に近い場合は，対数変換の前に $\varepsilon = 1.0 \times 10^{-12}$ を加え，$\log(x+\varepsilon)$ として計算した。}
% \end{figure}

% Figure yyy visualizes, via a heatmap, the bottleneck distance between persistence diagrams obtained for two parameters $\theta$ and $\theta'$. On the diagonal ($\theta = \theta^\prime$), the bottleneck distance is zero, and it tends to increase as one moves away from the diagonal. Therefore, the smaller the parameter difference $\left\| \theta-\theta^\prime \right\|_\infty$, the smaller the difference between the corresponding persistence diagrams, and the bottleneck distance remains small.

% Next, we directly compare the persistence diagrams themselves and visually confirm that, when the parameter difference is small, the change in the diagram is also small. Figure~z shows persistence diagrams for each parameter $\theta$ and a small perturbation $\theta^\prime$. As illustrated in Figure~z, when $\left\| \theta-\theta^\prime \right\|_\infty$ is small, the corresponding persistence diagrams are highly similar, providing a visual confirmation that small parameter perturbations lead to only small changes in the persistence diagrams.

% Overall, these numerical simulations confirm that inequality \eqref{eq:main-theorem-gs} holds numerically for Turing patterns arising from the Gray--Scott model. Moreover, the heatmap and the direct comparison of persistence diagrams show that both the bottleneck distance and the change in the persistence diagrams remain small when the parameter difference is small, experimentally supporting the stability predicted by the theory. Finally, we also observe that the upper bound increases with time $t$ and becomes looser, suggesting that the inequality becomes less informative in the long-time regime.







